<footer>
  <div class="container">
    <div class="system-status">
      <span class="status-item caffeine"><i class="fas fa-coffee"></i> Caffeine: <span class="status-value" id="caffeine-val">90%</span></span>
      <span class="status-item redbull"><i class="fas fa-bolt"></i> Redbull: <span class="status-value" id="redbull-val">95%</span></span>
    </div>

    <div class="system-status">
      <span class="status-item stress"><i class="fas fa-fire"></i> Stress: <span class="status-value" id="stress-val">10%</span></span>
      <span class="status-item mental"><i class="fas fa-brain"></i> Mental: <span class="status-value" id="mental-val">85%</span></span>
      <span class="status-item patience"><i class="fas fa-hourglass-half"></i> Patience: <span class="status-value" id="patience-val">99%</span></span>
      <span class="status-item happiness"><i class="fas fa-smile"></i> Happiness: <span class="status-value" id="happiness-val">100%</span></span>
    </div>
    
    <div class="git-footer">
      <span class="git-part"><span class="git-label">Author:</span> <span class="git-value author">{{site.data.blogger.name}}</span></span>
      <span class="git-part"><span class="git-label">Commit:</span> <span class="git-value commit-id">f960742</span></span>
      <span class="git-part"><span class="git-label">Message:</span> <span class="git-value commit-msg">Stabilized distributed bio and optimized ozone production.</span></span>
    </div>
  </div>
</footer>

<div class="ozone-gauge-container">
  <div class="gauge">
    <div id="gauge-needle" class="gauge-needle"></div>
  </div>
  <span class="gauge-label">Ozone Levels</span>
</div>

<div id="panic-overlay" class="kernel-panic-overlay">
  <div class="panic-content">
    <h1 style="font-size: 3rem; margin-bottom: 1rem;">KERNEL PANIC</h1>
    <p>Critical system failure. All Gophers have escaped.</p>
    <p>Rebooting universe in <span id="panic-countdown">5</span>...</p>
    <div style="margin-top: 2rem; font-family: monospace; opacity: 0.7;">
      Error: PEBKAC_EXCEPTION<br>
      Address: 0xDEADBEEF
    </div>
  </div>
</div>

<div id="system-logs" class="system-logs"></div>

<!-- scripts -->
<script defer>
  // Dynamic Stats Logic
  function updateStats() {
    const random = (min, max) => Math.floor(Math.random() * (max - min + 1) + min);
    
    const update = (id, val, colorScale) => {
      const el = document.getElementById(id);
      if(el) {
        el.innerText = val + "%";
        if(colorScale === 'high-good') {
          el.style.color = val > 80 ? '#00ff9d' : (val > 40 ? '#facc15' : '#ff4757');
        } else if (colorScale === 'low-good') {
           el.style.color = val < 20 ? '#00ff9d' : (val < 50 ? '#facc15' : '#ff4757');
        } else if (colorScale === 'energy') {
           el.style.color = val > 80 ? '#ff4757' : (val > 40 ? '#facc15' : '#38bdf8');
        }
      }
    };

    update('caffeine-val', random(60, 100), 'energy');
    update('redbull-val', random(80, 150), 'energy');
    update('stress-val', random(0, 40), 'low-good');
    update('mental-val', random(70, 100), 'high-good');
    update('patience-val', random(50, 90), 'high-good');
    update('happiness-val', random(90, 100), 'high-good');
  }

  setInterval(updateStats, 3000);
  setTimeout(updateStats, 100);

  // Matrix Rain Logic
  const canvas = document.getElementById('matrix-canvas');
  if (canvas) {
    const ctx = canvas.getContext('2d');
    let width = canvas.width = canvas.parentElement.offsetWidth;
    let height = canvas.height = canvas.parentElement.offsetHeight;
    
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$λ<>{}[]';
    const fontSize = 14;
    const columns = width / fontSize;
    const drops = [];

    for (let i = 0; i < columns; i++) {
      drops[i] = 1;
    }

    function draw() {
      ctx.fillStyle = 'rgba(3, 7, 18, 0.05)';
      ctx.fillRect(0, 0, width, height);
      ctx.fillStyle = '#38bdf8'; // accent-primary
      ctx.font = fontSize + 'px monospace';

      for (let i = 0; i < drops.length; i++) {
        const text = characters.charAt(Math.floor(Math.random() * characters.length));
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if (drops[i] * fontSize > height && Math.random() > 0.975) {
          drops[i] = 0;
        }
        drops[i]++;
      }
    }

    let matrixInterval = setInterval(draw, 33);

    window.addEventListener('resize', () => {
      width = canvas.width = canvas.parentElement.offsetWidth;
      height = canvas.height = canvas.parentElement.offsetHeight;
    });
  }

  // Kernel Panic Easter Egg
  const terminalHeader = document.querySelector('.terminal-header');
  const panicOverlay = document.getElementById('panic-overlay');
  const panicCountdown = document.getElementById('panic-countdown');
  let clickCount = 0;

  if (terminalHeader) {
    terminalHeader.addEventListener('click', () => {
      clickCount++;
      if (clickCount === 3) {
        triggerPanic();
        clickCount = 0;
      }
      setTimeout(() => { clickCount = 0; }, 1000);
    });
  }

  function triggerPanic() {
    panicOverlay.classList.add('active');
    let count = 5;
    const interval = setInterval(() => {
      count--;
      panicCountdown.textContent = count;
      if (count === 0) {
        clearInterval(interval);
        panicOverlay.classList.remove('active');
      }
    }, 1000);
  }

  // Ozone Gauge Logic
  const needle = document.getElementById('gauge-needle');
  let lastScrollTop = 0;
  let ozoneLevel = 0;

  window.addEventListener('scroll', () => {
    const st = window.pageYOffset || document.documentElement.scrollTop;
    const delta = Math.abs(st - lastScrollTop);
    
    // Increase ozone based on scroll speed
    ozoneLevel = Math.min(180, ozoneLevel + delta * 0.5);
    lastScrollTop = st <= 0 ? 0 : st;
  }, false);

  // Decays ozone over time
  setInterval(() => {
    ozoneLevel = Math.max(0, ozoneLevel - 2);
    // Map 0-180 to -90 to 90 degrees
    if (needle) {
      needle.style.transform = `translateX(-50%) rotate(${ozoneLevel - 90}deg)`;
    }
  }, 50);

  // Floating System Logs Logic
  const logsContainer = document.getElementById('system-logs');
  const quirkyMessages = [
    { level: 'info', icon: 'fa-server', text: "Scaling microservices..." },
    { level: 'warn', icon: 'fa-battery-empty', text: "Red Bull level: CRITICAL" },
    { level: 'debug', icon: 'fa-bug', text: "Wrestling with Rust lifetimes... again." },
    { level: 'info', icon: 'fa-robot', text: "Automating the automation..." },
    { level: 'debug', icon: 'fa-database', text: "Benchmarking distributed state..." },
    { level: 'warn', icon: 'fa-bolt', text: "Ozone levels rising ⚡" },
    { level: 'error', icon: 'fa-fire', text: "Data center fire detected (This is fine)." },
    { level: 'info', icon: 'fa-network-wired', text: "Optimizing traffic pipelines..." },
    { level: 'debug', icon: 'fa-code-branch', text: "Satisfying the borrow checker..." },
    { level: 'warn', icon: 'fa-mug-hot', text: "Coffee cold. Re-heating required." },
    { level: 'info', icon: 'fa-box', text: "Statically linking sanity..." },
    { level: 'error', icon: 'fa-skull-crossbones', text: "Kernel Panic: Just kidding, lol." },
    { level: 'debug', icon: 'fa-file-code', text: "Converting anxiety into YAML..." },
    { level: 'info', icon: 'fa-vial', text: "Testing in production... YOLO." },
    { level: 'warn', icon: 'fa-biohazard', text: "Legacy code detected. Proceed with caution." },
    { level: 'debug', icon: 'fa-brain', text: "Neural networks pondering existence..." },
    { level: 'error', icon: 'fa-trash', text: "rm -rf / ... just kidding!" },
    { level: 'info', icon: 'fa-download', text: "Downloading more RAM..." },
    { level: 'warn', icon: 'fa-keyboard', text: "Keyboard not found. Press F1 to continue." },
    { level: 'debug', icon: 'fa-search', text: "Googling the error message..." },
    { level: 'info', icon: 'fa-layer-group', text: "Stacking overflows..." },
    { level: 'warn', icon: 'fa-magic', text: "It works on my machine." }
  ];

  function addLog() {
    if (!logsContainer) return;
    const log = quirkyMessages[Math.floor(Math.random() * quirkyMessages.length)];
    const logEntry = document.createElement('div');
    logEntry.className = `log-entry ${log.level}`;
    logEntry.innerHTML = `
      <i class="fas ${log.icon}"></i>
      <div class="log-content">
        <span style="font-weight: 800; opacity: 0.7;">[${log.level.toUpperCase()}]</span> ${log.text}
      </div>
    `;
    logsContainer.appendChild(logEntry);

    if (logsContainer.children.length > 4) {
      const firstChild = logsContainer.firstChild;
      firstChild.classList.add('fade-out');
      setTimeout(() => { if (firstChild.parentNode) logsContainer.removeChild(firstChild); }, 800);
    }

    setTimeout(() => {
      if (!logEntry.classList.contains('fade-out')) {
        logEntry.classList.add('fade-out');
        setTimeout(() => {
          if (logEntry.parentNode) logEntry.parentNode.removeChild(logEntry);
        }, 800);
      }
    }, 6000);
  }

  setInterval(addLog, 4000);
  setTimeout(addLog, 1000);

  // 1. Live Tail Log Logic - Context Aware & Funny
  const logPools = {
    rust: [
      "> Satisfying the borrow checker...",
      "> Fighting lifetimes... and winning.",
      "> Zero-cost abstractions intensifying...",
      "> Safe memory achieved (mostly).",
      "> Compiling... see you in 10 minutes.",
      "> Oxidation in progress...",
      "> Panicking safely..."
    ],
    golang: [
      "> Invoking the Gopher...",
      "> Compiling statically-linked sanity...",
      "> Handling errors like a pro...",
      "> Preventing goroutine leaks...",
      "> interface{} all the things.",
      "> if err != nil { panic(cpu) }",
      "> Garbage collecting your bad code..."
    ],
    kubernetes: [
      "> Wrangling YAML monsters...",
      "> Herding pods into the cloud...",
      "> Scaling to the moon...",
      "> Descheduling the unschedulable.",
      "> Ingressing the egress...",
      "> CrashLoopBackOff is my favorite state.",
      "> Waiting for sidecar to be ready..."
    ],
    k8s: [
      "> Wrangling YAML monsters...",
      "> Herding pods into the cloud...",
      "> Scaling to the moon...",
      "> Descheduling the unschedulable.",
      "> Ingressing the egress...",
      "> CrashLoopBackOff is my favorite state.",
      "> Waiting for sidecar to be ready..."
    ],
    terraform: [
      "> Planning infrastructure chaos...",
      "> Locking state... don't touch anything!",
      "> Destroying 0 resources (hopefully).",
      "> Cloud providers agreeing... for once.",
      "> HCL sorcery in progress...",
      "> Refreshing state (and coffee)...",
      "> Apply complete! Resources: 0 added, 1 destroyed."
    ],
    git: [
      "> Rewriting history (don't tell anyone)...",
      "> Resolving merge conflicts with prayer...",
      "> Stashing the mess under the rug...",
      "> Pushing with force... YOLO.",
      "> Git voodoo magic enabled.",
      "> git commit -m 'fixes stuff'...",
      "> Detached HEAD state (send help)."
    ],
    macos: [
      "> Cleaning up system junk...",
      "> Brewing dependencies...",
      "> Freeing up RAM for Chrome...",
      "> Optimizing plist files...",
      "> Polishing the apple...",
      "> Indexing Spotlight forever...",
      "> Spinning beach ball of death..."
    ],
    general: [
      "> Checking dependencies... OKish.",
      "> Linting source files... 0 errors found (miracle).",
      "> Squeezing binary buffers...",
      "> Optimizing kernel state...",
      "> Provisioning cloud resources...",
      "> Syncing distributed nodes...",
      "> Automating the automation...",
      "> Converting coffee into code...",
      "> Deleting cache (it was the problem)...",
      "> Re-aligning div elements...",
      "> Installing dependencies from the internet (unsafe)..."
    ]
  };

  // Project Build Timer Logic
  let buildInterval;
  window.startBuild = function(el) {
    if (el.classList.contains('built')) return;
    const timerEl = el.querySelector('.build-timer');
    const logsEl = el.querySelector('.build-logs');
    const tags = el.getAttribute('data-tags') || '';
    let startTime = 0;

    // Build context-specific pool
    let activePool = [...logPools.general];
    Object.keys(logPools).forEach(key => {
      if (tags.includes(key)) activePool = [...activePool, ...logPools[key]];
    });
    
    buildInterval = setInterval(() => {
      startTime += 0.1;
      timerEl.textContent = startTime.toFixed(1) + 's';

      // Add a log line every 0.3s
      if (Math.floor(startTime * 10) % 3 === 0) {
        const logLine = document.createElement('div');
        logLine.className = 'log-line';
        logLine.textContent = activePool[Math.floor(Math.random() * activePool.length)];
        logsEl.appendChild(logLine);
        if (logsEl.children.length > 3) logsEl.removeChild(logsEl.firstChild);
      }

      if (startTime >= 1.0) {
        clearInterval(buildInterval);
        el.classList.add('built');
      }
    }, 100);
  }

  window.resetBuild = function(el) {
    clearInterval(buildInterval);
    if (!el.classList.contains('built')) {
      el.querySelector('.build-timer').textContent = '0.0s';
      el.querySelector('.build-logs').innerHTML = '';
    }
  }

  // 3. Tag Terminal Filter Logic
  window.filterPosts = function(tag, btn) {
    const posts = document.querySelectorAll('.post');
    const buttons = document.querySelectorAll('.tag-item');
    
    buttons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    posts.forEach(post => {
      const postTags = post.getAttribute('data-tags');
      if (tag === 'all' || postTags.includes(tag.replace('_', ''))) {
        post.style.display = 'flex';
        gsap.fromTo(post, { opacity: 0, scale: 0.9 }, { opacity: 1, scale: 1, duration: 0.4 });
      } else {
        post.style.display = 'none';
      }
    });
  }

  // Reading Progress Logic
  window.onscroll = function() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    document.getElementById("scroll-progress").style.width = scrolled + "%";
  };

  // Simple entry animations
  gsap.from("nav", { y: -50, opacity: 0, duration: 1, ease: "power3.out" });
  gsap.from("header", { opacity: 0, duration: 1.2, delay: 0.2 });
  gsap.from(".post, .project", { 
    y: 50, 
    opacity: 0, 
    duration: 0.8, 
    stagger: 0.1, 
    ease: "power2.out",
    delay: 0.5
  });

  // Konami Code Easter Egg
  const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
  let konamiIndex = 0;

  document.addEventListener('keydown', (e) => {
    if (e.key === konamiCode[konamiIndex]) {
      konamiIndex++;
      if (konamiIndex === konamiCode.length) {
        activatePartyMode();
        konamiIndex = 0;
      }
    } else {
      konamiIndex = 0;
    }
  });

  function activatePartyMode() {
    alert("KONAMI CODE ACTIVATED! SYSTEM OVERLOAD IMMINENT!");
    
    // Add crazy CSS
    const style = document.createElement('style');
    style.innerHTML = `
      @keyframes party-spin {
        0% { transform: rotate(0deg); filter: hue-rotate(0deg); }
        50% { transform: rotate(2deg) scale(1.02); filter: hue-rotate(180deg); }
        100% { transform: rotate(0deg); filter: hue-rotate(360deg); }
      }
      body {
        animation: party-spin 2s infinite linear !important;
      }
    `;
    document.head.appendChild(style);
    
    // Trigger panic overlay too
    const panicOverlay = document.getElementById('panic-overlay');
    if (panicOverlay) {
        panicOverlay.classList.add('active');
        setTimeout(() => panicOverlay.classList.remove('active'), 5000);
    }
  }
</script>
<script defer src="{{site.baseurl}}/assets/js/lbox.js"></script>